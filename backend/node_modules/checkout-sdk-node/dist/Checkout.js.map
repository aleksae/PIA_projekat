{"version":3,"file":"Checkout.js","names":["determineHost","key","options","host","process","env","CKO_SECRET","CKO_ENVIRONMENT","toLowerCase","trim","CONFIG","LIVE_BASE_URL","SANDBOX_BASE_URL","client","environment","startsWith","replace","MBC_LIVE_SECRET_KEY_REGEX","test","NAS_LIVE_SECRET_KEY_REGEX","determineSecretKey","authKey","CKO_SECRET_KEY","NAS_SANDBOX_SECRET_KEY_REGEX","determinePublicKey","pk","CKO_PUBLIC_KEY","Checkout","constructor","auth","secret","CKO_CLIENT","scope","CKO_SCOPE","access","sk","config","timeout","DEFAULT_TIMEOUT","agent","undefined","headers","payments","ENDPOINTS","Payments","sources","Sources","tokens","Tokens","instruments","Instruments","webhooks","Webhooks","events","Events","disputes","Disputes","files","Files","reconciliation","Reconciliation","customers","Customers","hostedPayments","HostedPayments","giropay","Giropay","ideal","Ideal","fawry","Fawry","pagoFacil","PagoFacil","rapipago","Rapipago","boleto","Boleto","baloto","Baloto","oxxo","Oxxo","klarna","Klarna","sepa","Sepa","paymentLinks","PaymentLinks","risk","Risk","Access","forex","Forex","applePay","ApplePay","sessions","Sessions","workflows","Workflows","platforms","Platforms","transfers","Transfers","balances","Balances","cardMetadata","CardMetadata","reports","Reports","financial","Financial","issuing","Issuing"],"sources":["../src/Checkout.js"],"sourcesContent":["import * as CONFIG from './config';\r\nimport * as ENDPOINTS from './index';\r\n\r\nconst determineHost = (key, options) => {\r\n    // If specified, use the custom host\r\n    if (options && options.host) {\r\n        return options.host;\r\n    }\r\n\r\n    // Priority 1: oAuth environment vars\r\n    if (process.env.CKO_SECRET) {\r\n        if (\r\n            (process.env.CKO_ENVIRONMENT &&\r\n                process.env.CKO_ENVIRONMENT.toLowerCase().trim() === 'prod') ||\r\n            (process.env.CKO_ENVIRONMENT &&\r\n                process.env.CKO_ENVIRONMENT.toLowerCase().trim() === 'production') ||\r\n            (process.env.CKO_ENVIRONMENT &&\r\n                process.env.CKO_ENVIRONMENT.toLowerCase().trim() === 'live')\r\n        ) {\r\n            return CONFIG.LIVE_BASE_URL;\r\n        }\r\n        return CONFIG.SANDBOX_BASE_URL;\r\n    }\r\n    // Priority 2: oAuth declared vars\r\n    if (options && options.client) {\r\n        if (\r\n            (options.environment && options.environment.toLowerCase().trim() === 'prod') ||\r\n            (options.environment && options.environment.toLowerCase().trim() === 'production') ||\r\n            (options.environment && options.environment.toLowerCase().trim() === 'live')\r\n        ) {\r\n            return CONFIG.LIVE_BASE_URL;\r\n        }\r\n        return CONFIG.SANDBOX_BASE_URL;\r\n    }\r\n\r\n    // Priority 3: MBC or NAS static keys\r\n    if (key.startsWith('Bearer')) {\r\n        // eslint-disable-next-line no-param-reassign\r\n        key = key.replace('Bearer', '').trim();\r\n    }\r\n    return CONFIG.MBC_LIVE_SECRET_KEY_REGEX.test(key) || CONFIG.NAS_LIVE_SECRET_KEY_REGEX.test(key)\r\n        ? CONFIG.LIVE_BASE_URL\r\n        : CONFIG.SANDBOX_BASE_URL;\r\n};\r\n\r\nconst determineSecretKey = (key) => {\r\n    // Unless specified, check environment variables for the key\r\n    let authKey = !key ? process.env.CKO_SECRET_KEY || '' : key;\r\n\r\n    // In case of NAS static keys, append the Bearer prefix\r\n    if (\r\n        CONFIG.NAS_LIVE_SECRET_KEY_REGEX.test(authKey) ||\r\n        CONFIG.NAS_SANDBOX_SECRET_KEY_REGEX.test(authKey)\r\n    ) {\r\n        authKey =\r\n            authKey.startsWith('Bearer') || authKey.startsWith('bearer')\r\n                ? authKey\r\n                : `Bearer ${authKey}`;\r\n    }\r\n\r\n    return authKey;\r\n};\r\n\r\nconst determinePublicKey = (options) => {\r\n    // Unless specified, check environment variables for the key\r\n    let pk;\r\n    if (options && options.pk) {\r\n        pk = options.pk;\r\n    } else {\r\n        pk = process.env.CKO_PUBLIC_KEY || '';\r\n    }\r\n    return pk;\r\n};\r\n\r\n/**\r\n * Main Checkout.com SDK class\r\n *\r\n * @export\r\n * @class Checkout\r\n */\r\nexport default class Checkout {\r\n    /**\r\n     * Creates an instance of Checkout.com's SDK.\r\n     *\r\n     * Determines the environment based on the key\r\n     *\r\n     * @constructor\r\n     * @param {string} [key] Secret Key /^(sk)\r\n     * @param {Object}  [options] Configuration options\r\n     * @memberof Payments\r\n     */\r\n    constructor(key, options) {\r\n        let auth;\r\n        if (process.env.CKO_SECRET) {\r\n            // For NAS with environment vars\r\n            auth = {\r\n                secret: process.env.CKO_SECRET,\r\n                client: process.env.CKO_CLIENT,\r\n                scope: process.env.CKO_SCOPE || 'gateway',\r\n                host: determineHost(null, options),\r\n                access: null,\r\n            };\r\n        } else if (process.env.CKO_SECRET_KEY) {\r\n            // For MBC or NAS with static keys from environment vars\r\n            auth = {\r\n                sk: determineSecretKey(process.env.CKO_SECRET_KEY),\r\n                pk: determinePublicKey(process.env.CKO_PUBLIC_KEY),\r\n                host: determineHost(determineSecretKey(key), options),\r\n            };\r\n        } else if (options && options.client) {\r\n            // For NAS with declared vars\r\n            auth = {\r\n                secret: key,\r\n                pk: determinePublicKey(options),\r\n                client: options.client,\r\n                scope: options.scope || 'gateway',\r\n                host: determineHost(null, options),\r\n                access: null,\r\n            };\r\n        } else {\r\n            // For MBC or NAS with static keys with declared vars\r\n            auth = {\r\n                sk: determineSecretKey(key, options),\r\n                pk: determinePublicKey(options),\r\n                host: determineHost(determineSecretKey(key), options),\r\n            };\r\n        }\r\n\r\n        this.config = {\r\n            ...auth,\r\n            timeout: options && options.timeout ? options.timeout : CONFIG.DEFAULT_TIMEOUT,\r\n            agent: options && options.agent ? options.agent : undefined,\r\n            headers: options && options.headers ? options.headers : {},\r\n            access: undefined,\r\n        };\r\n\r\n        this.payments = new ENDPOINTS.Payments(this.config);\r\n        this.sources = new ENDPOINTS.Sources(this.config);\r\n        this.tokens = new ENDPOINTS.Tokens(this.config);\r\n        this.instruments = new ENDPOINTS.Instruments(this.config);\r\n        this.webhooks = new ENDPOINTS.Webhooks(this.config);\r\n        this.events = new ENDPOINTS.Events(this.config);\r\n        this.disputes = new ENDPOINTS.Disputes(this.config);\r\n        this.files = new ENDPOINTS.Files(this.config);\r\n        this.reconciliation = new ENDPOINTS.Reconciliation(this.config);\r\n        this.customers = new ENDPOINTS.Customers(this.config);\r\n        this.hostedPayments = new ENDPOINTS.HostedPayments(this.config);\r\n        this.giropay = new ENDPOINTS.Giropay(this.config);\r\n        this.ideal = new ENDPOINTS.Ideal(this.config);\r\n        this.fawry = new ENDPOINTS.Fawry(this.config);\r\n        this.pagoFacil = new ENDPOINTS.PagoFacil(this.config);\r\n        this.rapipago = new ENDPOINTS.Rapipago(this.config);\r\n        this.boleto = new ENDPOINTS.Boleto(this.config);\r\n        this.baloto = new ENDPOINTS.Baloto(this.config);\r\n        this.oxxo = new ENDPOINTS.Oxxo(this.config);\r\n        this.klarna = new ENDPOINTS.Klarna(this.config);\r\n        this.sepa = new ENDPOINTS.Sepa(this.config);\r\n        this.paymentLinks = new ENDPOINTS.PaymentLinks(this.config);\r\n        this.risk = new ENDPOINTS.Risk(this.config);\r\n        this.access = new ENDPOINTS.Access(this.config);\r\n        this.forex = new ENDPOINTS.Forex(this.config);\r\n        this.applePay = new ENDPOINTS.ApplePay(this.config);\r\n        this.sessions = new ENDPOINTS.Sessions(this.config);\r\n        this.workflows = new ENDPOINTS.Workflows(this.config);\r\n        this.platforms = new ENDPOINTS.Platforms(this.config);\r\n        this.transfers = new ENDPOINTS.Transfers(this.config);\r\n        this.balances = new ENDPOINTS.Balances(this.config);\r\n        this.cardMetadata = new ENDPOINTS.CardMetadata(this.config);\r\n        this.reports = new ENDPOINTS.Reports(this.config);\r\n        this.financial = new ENDPOINTS.Financial(this.config);\r\n        this.issuing = new ENDPOINTS.Issuing(this.config);\r\n    }\r\n}\r\n"],"mappings":"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"}